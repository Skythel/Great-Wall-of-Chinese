<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Great Wall of Chinese</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
    <!-- <script type="module" src="src/idioms.js"></script> -->

     <!-- Booststrap (CSS) assets -->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
     <!-- Font Awesome (icons) assets -->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav" id="teacherNavBar">
            <a class="nav-item nav-link my-0" href='#' data-bs-toggle="modal" data-bs-target="#createCustomLevel-modal">Create custom level</a>
            <a class="nav-item nav-link my-0" href='#' data-bs-toggle="modal" data-bs-target="#viewCustomLevel-modal">View custom level</a>
            <a class="nav-item nav-link my-0" href='world_selection.html'>Change World</a>
            <a class="nav-item nav-link my-0" href="#" data-bs-toggle="modal" data-bs-target="#leaderboard-modal">Leaderboard</a>
          </div>
        </div>
          <form class="form-inline">
              <button id="teacherLogOut" class="btn btn-danger mx-2" type="button" data-bs-toggle="modal" data-bs-target="#logout-modal">Log out</button>
          </form>
      </nav>
    <div id="idiomWorld"></div>

    <!--Create custom level Modal starts here-->
    <div class="modal fade" id="createCustomLevel-modal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="modal-title" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header justify-content-center">
            <h4 class="modal-title" id="modal-title">Create custom level</h4>
          </div>
          <div class="modal-body">
            <div class="container">
              <div class="row text-center">
                <div class="col auto">
                  <select type="text" name="questionType" class="form-control my-3" >
                    <option value="" selected disabled>Question 1</option>
                    <option value="Idoims">Idoims</option>
                    <option value="Hanyu Pinyin">Hanyu Pinyin</option>
                    <option value="Fill in the blanks">Fill in the blanks</option>
                  </select>
                  <select type="text" name="questionType" class="form-control my-3" >
                    <option value="" selected disabled>Question 2</option>
                    <option value="Idoims">Idoims</option>
                    <option value="Hanyu Pinyin">Hanyu Pinyin</option>
                    <option value="Fill in the blanks">Fill in the blanks</option>
                  </select>
                  <select type="text" name="questionType" class="form-control my-3" >
                    <option value="" selected disabled>Question 3</option>
                    <option value="Idoims">Idoims</option>
                    <option value="Hanyu Pinyin">Hanyu Pinyin</option>
                    <option value="Fill in the blanks">Fill in the blanks</option>
                  </select>
                  <select type="text" name="questionType" class="form-control my-3" >
                    <option value="" selected disabled>Question 4</option>
                    <option value="Idoims">Idoims</option>
                    <option value="Hanyu Pinyin">Hanyu Pinyin</option>
                    <option value="Fill in the blanks">Fill in the blanks</option>
                  </select>
                  <select type="text" name="questionType" class="form-control my-3" >
                    <option value="" selected disabled>Question 5</option>
                    <option value="Idoims">Idoims</option>
                    <option value="Hanyu Pinyin">Hanyu Pinyin</option>
                    <option value="Fill in the blanks">Fill in the blanks</option>
                  </select>
                </div>
                <div class="col auto">
                  <select type="text" name="difficulty" class="form-control my-3" >
                    <option value="" selected disabled>Select difficulty</option>
                    <option value="Easy">Easy</option>
                    <option value="Medium">Medium</option>
                    <option value="Difficult">Difficult</option>
                  </select>
                  <select type="text" name="difficulty" class="form-control my-3" >
                    <option value="" selected disabled>Select difficulty</option>
                    <option value="Easy">Easy</option>
                    <option value="Medium">Medium</option>
                    <option value="Difficult">Difficult</option>
                  </select>
                  <select type="text" name="difficulty" class="form-control my-3" >
                    <option value="" selected disabled>Select difficulty</option>
                    <option value="Easy">Easy</option>
                    <option value="Medium">Medium</option>
                    <option value="Difficult">Difficult</option>
                  </select>
                  <select type="text" name="difficulty" class="form-control my-3" >
                    <option value="" selected disabled>Select difficulty</option>
                    <option value="Easy">Easy</option>
                    <option value="Medium">Medium</option>
                    <option value="Difficult">Difficult</option>
                  </select>
                  <select type="text" name="difficulty" class="form-control my-3" >
                    <option value="" selected disabled>Select difficulty</option>
                    <option value="Easy">Easy</option>
                    <option value="Medium">Medium</option>
                    <option value="Difficult">Difficult</option>
                  </select>
                </div>
              </div>
              <div class="row text-center justify-content-center mt-3">
                <div class="col-auto">
                  <input class="form-control" type="text" id="customLevelName" placeholder="Custom level name" aria-label="Search">
                </div>
                <div class="col-auto">
                  <button onclick="saveCustomLevel()" class="btn btn-success" type="submit" id="saveCustomLevelBtn">Save Custom level</button>
                </div>
              </div>
            </div>
            <div id="response"></div>
          </div>
          <div class="modal-footer justify-content-center">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
  </div>
  <!--Create custom level Modal ends here-->

  <!--View custom level Modal starts here-->
  <div class="modal fade" id="viewCustomLevel-modal" tabindex="-1" aria-labelledby="modal-title" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header justify-content-center">
          <h4 class="modal-title" id="modal-title">View custom levels</h4>
        </div>
        <div class="modal-body">
          <div class="container">
            <table class="table table-bordered table-light">
              <thead>
                <tr>
                  <th scope="col">Level name</th>
                  <th scope="col">Actions</th>
                </tr>
              </thead>
              <tbody id="viewCustomLevel">
              </tbody>
            </table>
          </div>
          <div id="response"></div>
        </div>
        <div class="modal-footer justify-content-center">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <!--View custom level Modal ends here-->

  <!--Leaderboard Modal starts here-->
  <div class="modal fade" id="leaderboard-modal" tabindex="-1" aria-labelledby="modal-title" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header justify-content-center">
        <h3 class="modal-title" id="modal-title">Leaderboard</h3>
      </div>
      <div class="modal-body">
        <div class="container text-left">
          <h4>Adventure mode</h4>
          <table class="table table-bordered table-dark">
            <thead>
              <tr>
                <th scope="col">Position</th>
                <th scope="col">Name</th>
                <th scope="col">Accuracy</th>
              </tr>
            </thead>
            <tbody id="adventureModeLeaderBoard">
            </tbody>
          </table>
        </div>
        <div class="container mt-5 text-left">
          <h4>PVP mode</h4>
          <table class="table table-bordered table-dark">
            <thead>
              <tr>
                <th scope="col">Position</th>
                <th scope="col">Name</th>
                <th scope="col">Rank</th>
                <th scope="col">Accuracy</th>
              </tr>
            </thead>
            <tbody id="pvpModeLeaderBoard">
            </tbody>
          </table>
        </div>
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
  </div>
  <!--Leaderboard Modal ends here-->

  <!--Adventure mode Modal starts here-->
  <div class="modal fade" id="adventureMode-modal" tabindex="-1" aria-labelledby="modal-title" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modal-title">Adventure Mode</h5>
          </div>
          <div class="modal-body">
            
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
  </div>
  <!--Adventure mode Modal ends here--> 

  <!--Logout Modal starts here-->
  <div class="modal fade" id="logout-modal" tabindex="-1" aria-labelledby="modal-title" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modal-title">Log Out</h5>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to log out?</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <a href="../scripts/function_logout" type="button" class="btn btn-danger" id="logout">Log out</a>
          </div>
        </div>
      </div>
  </div>
  <!--Logout Modal ends here--> 

  <script src="src/idioms.js"></script>
</body>
<script>
  function saveCustomLevel(){
    let emptyFields = false;
    let customLevelName = document.getElementById("customLevelName").value;
    if(!customLevelName){
      emptyFields = true;
    }
    let allQuestions = document.querySelectorAll("[name='questionType']");
    let allDifficulty = document.querySelectorAll("[name='difficulty']");
    for(let i=0; i<allQuestions.length; i++){
      if(!allQuestions[i].value||!allDifficulty[i].value){
        emptyFields=true;
        break;
      }
    }
    if(emptyFields){
  		document.getElementById('response').innerHTML = `<div class="alert alert-danger my-2" role="alert">Please fill in all the fields!</div>`
    }else{
      // link backend here to save custom level
      document.getElementById('response').innerHTML = `<div class="alert alert-success my-2" role="alert">Assignment created successfully!</div>`
    }
  }

  let viewCustomLevelModal = document.getElementById('viewCustomLevel-modal');
	viewCustomLevelModal.addEventListener('show.bs.modal', function (event){
    var table = document.getElementById("viewCustomLevel");
    var rowsHTML = ""; // initialise empty var to hold html of all the rows

    var row = '<tr><td>TESTING ROW</td><td><button onclick="deleteCustomLevel(event)"><i class="fa fa-trash"></i></button></td></tr>';
    table.innerHTML = row;

    //link backend here to get custom level names --> customLevelName
    // for(i=0;i<customLevelName.length;i++){
    //   var row = '<tr><td>' + customLevelName[i] + '</td><td><button onclick="deleteCustomLevel(event)"><i class="fa fa-trash"></i></button></td></tr>';
    //   rowsHTML += row; // add in html code
    // }

    // table.innerHTML = rowsHTML; //set innerhtml code
	})

  function deleteCustomLevel(e){
    let rowElements = e.srcElement.parentElement.parentElement.parentElement; // row elements refer to both level name and actions
    let customLevelName = rowElements.firstChild.firstChild.innerHTML;
    //console.log(rowElements.firstChild.firstChild.innerHTML);

    // link delete custom level script here, send customLevelName
    // if successful, remove elements
	  rowElements.remove();
  }

  let leaderBoardModal = document.getElementById('leaderboard-modal');
	leaderBoardModal.addEventListener('show.bs.modal', function (event){
		var adventureMode = viewCustomLevelModal.querySelector('#adventureModeLeaderBoard'); // Table body for adventure mode leaderboard
    var pvpMode = viewCustomLevelModal.querySelector('#pvpModeLeaderBoard'); // Table body for pvp mode leaderboard

    //link backend here to get leaderboard details
	})

</script>
<script src="../websocket/socket.js"></script>
</html>